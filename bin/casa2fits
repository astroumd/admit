#! /usr/bin/env casarun
#-*- mode: python -*-
#
#   casa2fits   :   bulk conversion of casa images to fits files
#
#   Usage:      casa2fits  *.im
#               casa2fits `cat file`
#               ---------> file is a text file containing a bunch of fits files

version  = '2-mar-2023'


# =================================================================================================================
# python system modules
import sys, os, math
import admit

try:
  # casa5
  import taskinit
  import casa
except:
  try:
    # casa6
    import casatasks as casa
    import taskinit
  except:
    print("WARNING: problem importing CASA modules")


argv = admit.utils.casa_argv(sys.argv)

total = len(argv)-1
i       = 0
verbose = False
echop   = False

for ff in argv[1:]:
    i = i + 1

    if ff=='-v':
      verbose = True
      continue
    if ff=='-e':
      echop = True

    shape = str(casa.imhead(ff,mode='list')['shape'])

    print("(%d/%d) %s %s" % (i,total,ff,shape))
    casa.exportfits(ff,ff+'.fits',overwrite=True)
    

