<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Van der Monde Matrix/Polynomial Fit to Continuum &mdash; ADMIT 0.4.1 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '0.4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ADMIT 0.4.1 documentation" href="../../../../index.html" />
    <link rel="up" title="Python Scripting Interface" href="../../../../api.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">ADMIT 0.4.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../../../api.html" accesskey="U">Python Scripting Interface</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander"></span><div class="section" id="van-der-monde-matrix-polynomial-fit-to-continuum">
<span id="svdvander"></span><h1>Van der Monde Matrix/Polynomial Fit to Continuum<a class="headerlink" href="#van-der-monde-matrix-polynomial-fit-to-continuum" title="Permalink to this headline">¶</a></h1>
<p>Method to fit a polynomial to the continuum using a
Van der Monde Matrix.</p>
<dl class="class">
<dt id="admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander.SVD_Vander">
<em class="property">class </em><code class="descclassname">admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander.</code><code class="descname">SVD_Vander</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/admit/util/continuumsubtraction/spectral/algorithms/SVD_Vander.html#SVD_Vander"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander.SVD_Vander" title="Permalink to this definition">¶</a></dt>
<dd><p>Class which calculates the continuum of a 1D spectrum.
The algorithm can be controlled by arguments to the run() method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : numpy array</p>
<blockquote>
<div><p>An array containing the x coordinates</p>
</div></blockquote>
<p><strong>y</strong> : masked array</p>
<blockquote class="last">
<div><p>A masked array containing the y coordinates with any
strong emission masked</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>None</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander.SVD_Vander.baseline" title="admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander.SVD_Vander.baseline"><code class="xref py py-obj docutils literal"><span class="pre">baseline</span></code></a>([spec,&nbsp;deg,&nbsp;max_it,&nbsp;tol])</td>
<td>Computes the baseline of a given data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander.SVD_Vander.run" title="admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander.SVD_Vander.run"><code class="xref py py-obj docutils literal"><span class="pre">run</span></code></a>(**keyval)</td>
<td>Method to calculate the continuum from the given masked spectrum.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander.SVD_Vander.baseline">
<code class="descname">baseline</code><span class="sig-paren">(</span><em>spec=[]</em>, <em>deg=0</em>, <em>max_it=100</em>, <em>tol=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/admit/util/continuumsubtraction/spectral/algorithms/SVD_Vander.html#SVD_Vander.baseline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander.SVD_Vander.baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the baseline of a given data.</p>
<p>Iteratively performs a polynomial fitting in the data to detect its
baseline. At every iteration, the fitting weights on the regions 
with peaks is reduced to identify the baseline only.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>spec</strong> : numpy array</p>
<blockquote>
<div><p>The spectrum from which the baseline is determined</p>
</div></blockquote>
<p><strong>deg</strong> : int</p>
<blockquote>
<div><p>Degree of the polynomial that will estimate the data baseline.
A low degree may fail to detect all the baseline present, while
a high degree may make the data too oscillatory, especially at
the edges.
Default: 0</p>
</div></blockquote>
<p><strong>max_it</strong> : int</p>
<blockquote>
<div><p>Maximum number of iterations to perform.
Default: 100</p>
</div></blockquote>
<p><strong>tol</strong> : float</p>
<blockquote>
<div><p>Tolerance to use when comparing the difference between the
current fit coefficient and the ones from the last iteration.
The iteration procedure will stop when the difference between
them is lower than <em>tol</em>.
Default: 1e-3</p>
</div></blockquote>
<p><strong>dropzero</strong> : bool</p>
<blockquote>
<div><p>Whether or not to drop values of 0.0. Useful when the end channels
are 0.0, can cause poor baseline determination if used when 0.0
is in the middle and order is not 0.
Default: False</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">ndarray</p>
<blockquote class="last">
<div><p>Array with the baseline amplitude for every original point in <em>y</em></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander.SVD_Vander.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>**keyval</em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/admit/util/continuumsubtraction/spectral/algorithms/SVD_Vander.html#SVD_Vander.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#admit.util.continuumsubtraction.spectral.algorithms.SVD_Vander.SVD_Vander.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to calculate the continuum from the given masked spectrum.
If search=True is given as an argument then the algorithm will
iterate through the different order polynomials to find the best fit,
based on noise level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>keyval</strong> : dictionary</p>
<blockquote>
<div><p>Dictionary containing the keyword value pair arguments</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">numpy array containing the best fit continuum</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Arguments for the run method:</p>
<ul class="simple">
<li>search : bool, whether or not to search for the best fit. Default: False</li>
<li>deg : int, the order of polynomial to fit. Default: 0</li>
<li>max_it : int, the maximum number of iterations to perform. Default: 100</li>
<li>tol : float, tolerance used to determine the fit has converged. Default: 1e-3</li>
</ul>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../_sources/module/admit.util.continuumsubtraction/spectral/algorithms/SVD_Vander.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../index.html">ADMIT 0.4.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../../../api.html" >Python Scripting Interface</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, The ADMIT Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>