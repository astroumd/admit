<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Examples of various rst directives &#8212; ADMIT 1.0.6 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="ADMIT 1.0.6 documentation" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ADMIT 1.0.6 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="examples-of-various-rst-directives">
<h1>Examples of various rst directives<a class="headerlink" href="#examples-of-various-rst-directives" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://openalea.gforge.inria.fr/doc/openalea/doc/_build/html/source/sphinx/rest_syntax.html">Here&#8217;s a cheatsheet.</a></p>
<div class="section" id="code">
<h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2>
<p>Example:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">parser</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">Parser</span><span class="p">(</span><span class="s2">&quot;myfile.xml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_function</span><span class="p">():</span>
    <span class="s2">&quot;just a test&quot;</span>
    <span class="nb">print</span> <span class="mi">8</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
<p>end example.</p>
<p>Include a python file:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env casarun</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#   admit4.py :  example flow to read in an ascii spectrum and run it through LineSegments and LineID</span>
<span class="c1">#                The spectrum needs freq (in GHz) in col1 and intensity (arbitrary units) in col5.</span>
<span class="c1">#</span>
<span class="c1">#   Usage:      $ADMIT/admit/test/admit4.py  [options] spectrum.tab</span>
<span class="c1">#</span>
<span class="c1">#   this will create a spectrum.admit directory with all the BDP&#39;s and associated data products inside.</span>
<span class="c1">#</span>
<span class="c1">#   Note that the current ADMIT will create files like testCubeSpectrum.tab, testCubeStats.tab and</span>
<span class="c1">#   testPVCorr.tab inside the .admit directory for you to run them through admit4.py</span>
<span class="c1">#</span>
<span class="c1">#   A typical run with 100 channels takes about 10&quot; (fair amount of casa overhead,</span>
<span class="c1">#   even though none is used here; cpu in the 3 tasks is only little over 4&quot;)</span>
<span class="c1">#</span>
<span class="c1">#   time $ADMIT/admit/test/admit4.py --alias x testCubeSpectrum.tab &gt; testCubeSpectrum.tab.log</span>
<span class="c1">#   7.584u 2.345s 0:10.15 97.7%	0+0k 0+2584io 0pf+0w</span>
<span class="c1">#   TIMING : Dtime: CubeSpectrum END [ 0.294537   0.4536109]</span>
<span class="c1">#   TIMING : Dtime: LineSegment END [ 2.14727     2.17343116]</span>
<span class="c1">#   TIMING : Dtime: LineID END [ 2.105823    2.14143705]</span>
<span class="c1">#</span>
<span class="c1">#   Options:</span>
<span class="c1">#   -a  alias          (doesn&#39;t actually work)</span>
<span class="c1">#   -r  apar_file</span>
<span class="c1">#   -o  output_dir</span>
<span class="c1">#   -s  stop_label</span>
<span class="c1">#</span>
<span class="c1">#   @todo  make it also understand bdp&#39;s</span>
<span class="c1">#</span>
<span class="c1"># =================================================================================================================</span>
<span class="c1"># python system modules</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">argparse</span> <span class="kn">as</span> <span class="nn">ap</span>

<span class="kn">import</span> <span class="nn">admit</span>

<span class="n">version</span>  <span class="o">=</span> <span class="s1">&#39;30-mar-2016&#39;</span>

<span class="c1">#  ===&gt;&gt;&gt; set some parameters for this run &lt;&lt;&lt;=================================================================</span>
<span class="c1">#</span>
<span class="c1">#  !!! do not change these defaults, these are meant to be our desired defaults    !!!</span>
<span class="c1">#  !!! in an ideal universe. Instead, use the commented section below to enable    !!!</span>
<span class="c1">#  !!! them, or add your favorites to some new value to experiment with.           !!!</span>


<span class="nb">file</span>     <span class="o">=</span> <span class="s1">&#39;&#39;</span>               <span class="c1"># the default FITS input name to be ingested (basename is used for apar file)</span>
<span class="n">alias</span>    <span class="o">=</span> <span class="s1">&#39;&#39;</span>               <span class="c1"># -a --alias : use a short alias instead of the possibly long basename?</span>
<span class="n">apar</span>     <span class="o">=</span> <span class="s1">&#39;&#39;</span>               <span class="c1"># -r --apar:   add this apar as well (file.apar is also checked for)</span>
<span class="n">out</span>      <span class="o">=</span> <span class="s1">&#39;&#39;</span>               <span class="c1"># -o --out:    alternative output admit name (instead of file.admit)</span>
<span class="n">stop</span>     <span class="o">=</span> <span class="s1">&#39;&#39;</span>               <span class="c1"># -s --stop:   early labeled bailout (&#39;ingest&#39;, ...)</span>

<span class="n">plot</span>     <span class="o">=</span> <span class="s1">&#39;t&#39;</span>              <span class="c1">#</span>
<span class="c1">#</span>
<span class="n">vlsr</span>     <span class="o">=</span> <span class="mf">0.0</span>              <span class="c1"># either set it below, or make get_vlsr() to work (else vlsr=0 will be used)</span>
<span class="n">plotmode</span> <span class="o">=</span> <span class="n">admit</span><span class="o">.</span><span class="n">PlotControl</span><span class="o">.</span><span class="n">BATCH</span> <span class="c1"># NOPLOT, BATCH, INTERACTIVE, SHOW_AT_END</span>
<span class="n">plottype</span> <span class="o">=</span> <span class="n">admit</span><span class="o">.</span><span class="n">PlotControl</span><span class="o">.</span><span class="n">PNG</span>   <span class="c1"># PNG, JPG, etc.</span>
<span class="n">loglevel</span> <span class="o">=</span> <span class="mi">10</span>               <span class="c1"># 10=DEBUG, 15=TIMING 20=INFO 30=WARNING 40=ERROR 50=FATAL</span>
<span class="c1">#</span>
<span class="n">doClean</span>  <span class="o">=</span> <span class="bp">True</span>
<span class="n">lineUID</span>  <span class="o">=</span> <span class="bp">False</span>            <span class="c1"># if True, this would run LineID(identifylines=False) [old relic]</span>
<span class="n">linepar</span>  <span class="o">=</span> <span class="p">()</span>               <span class="c1"># if set, (numsigma,minchan,maxgap)</span>
<span class="n">llsmooth</span> <span class="o">=</span> <span class="p">[]</span>               <span class="c1"># smooothing for LineSegment and LineID</span>
<span class="n">iterate</span>  <span class="o">=</span> <span class="bp">True</span>             <span class="c1">#</span>
<span class="n">csub</span>     <span class="o">=</span> <span class="bp">None</span>             <span class="c1"># or 0,1,2,....</span>
<span class="n">online</span>   <span class="o">=</span> <span class="bp">False</span>
<span class="n">tier1width</span> <span class="o">=</span> <span class="mf">0.0</span>            <span class="c1">#</span>
<span class="c1">#</span>
<span class="n">reflist</span>  <span class="o">=</span> <span class="s1">&#39;etc/co_lines.list&#39;</span>    <span class="c1"># pick one from $ADMIT/etc</span>
<span class="c1">#-----------------------------------------------------------------------------------------------------------------------</span>
<span class="c1">#-------------------- command line parsing -----------------------------------------------------------------------------</span>
<span class="c1">#                     @todo cannot overload casa, it parses first (e.g. -c)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">argv</span> <span class="o">=</span> <span class="n">admit</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">casa_argv</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Process a single FITS continuum and optional PB correction&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-a&#39;</span><span class="p">,</span><span class="s1">&#39;--alias&#39;</span> <span class="p">,</span><span class="n">nargs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Alias&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span><span class="s1">&#39;--out&#39;</span>   <span class="p">,</span><span class="n">nargs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Optional output admit directory basename, instead derived from file&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-r&#39;</span><span class="p">,</span><span class="s1">&#39;--apar&#39;</span>  <span class="p">,</span><span class="n">nargs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;ADMIT parameter file (in addition to &quot;file.apar&quot;&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span><span class="s1">&#39;--stop&#39;</span>  <span class="p">,</span><span class="n">nargs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;early bailout label&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;file&#39;</span>         <span class="p">,</span><span class="n">nargs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;FITSMap (or CASA image, or MIRIAD image)&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--version&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(prog)s</span><span class="s1"> &#39;</span> <span class="o">+</span> <span class="n">version</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">args</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">())</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>   <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span> <span class="nb">file</span>   <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;alias&#39;</span><span class="p">]</span>  <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span> <span class="n">alias</span>  <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;alias&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;apar&#39;</span><span class="p">]</span>   <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span> <span class="n">apar</span>   <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;apar&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">]</span>    <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span> <span class="n">out</span>    <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span>   <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span> <span class="n">stop</span>   <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="n">admit</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">assert_files</span><span class="p">([</span><span class="nb">file</span><span class="p">])</span>                <span class="c1"># this will halt the script if something doesn&#39;t exist</span>

<span class="c1">#if plot == &quot;f&quot;: </span>
<span class="c1">#    plotmode=admit.PlotControl.NONE</span>

<span class="c1">#-----------------------------------------------------------------------------------------------------------------------</span>
<span class="c1">#------------------------------------------------------- start of script -----------------------------------------------</span>

<span class="c1">#  announce version</span>
<span class="k">print</span> <span class="s1">&#39;ADMIT4: Version &#39;</span><span class="p">,</span><span class="n">version</span>

<span class="c1">#  do the work in a proper &quot;.admit&quot; directory</span>
<span class="n">adir</span> <span class="o">=</span>  <span class="n">admit</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">admit_dir</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span><span class="n">out</span><span class="p">)</span>
<span class="c1">#   dirty method, it really should check if adir is an admit directory</span>
<span class="k">if</span> <span class="n">doClean</span> <span class="ow">and</span> <span class="n">adir</span> <span class="o">!=</span> <span class="nb">file</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;Removing previous results from &quot;</span><span class="p">,</span><span class="n">adir</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;rm -rf </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">adir</span><span class="p">)</span>
    <span class="n">create</span><span class="o">=</span><span class="bp">True</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">create</span><span class="o">=</span><span class="bp">False</span>


<span class="c1"># parse apar file(s) first, overwriting local apar variables</span>
<span class="k">for</span> <span class="n">ap1</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;admit4.apar&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">+</span><span class="s2">&quot;.apar&quot;</span><span class="p">,</span> <span class="n">apar</span><span class="p">]:</span>         <span class="c1"># loop over 3 possible apar files, set parameters</span>
    <span class="k">if</span> <span class="n">ap1</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">ap1</span><span class="p">):</span>
        <span class="k">print</span> <span class="s2">&quot;Found parameter file &quot;</span><span class="p">,</span><span class="n">ap1</span>
        <span class="nb">execfile</span><span class="p">(</span><span class="n">ap1</span><span class="p">)</span>
        
<span class="n">a</span> <span class="o">=</span> <span class="n">admit</span><span class="o">.</span><span class="n">Project</span><span class="p">(</span><span class="n">adir</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Testing ADMIT4 style pipeline - version </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">version</span><span class="p">,</span><span class="n">create</span><span class="o">=</span><span class="n">create</span><span class="p">,</span><span class="n">loglevel</span><span class="o">=</span><span class="n">loglevel</span><span class="p">)</span>

<span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">new</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;Starting a new ADMIT using &quot;</span><span class="p">,</span><span class="nb">file</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;cp -a </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">adir</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">admit_dir</span><span class="o">=</span><span class="n">adir</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;admit4.apar&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">+</span><span class="s2">&quot;.apar&quot;</span><span class="p">,</span> <span class="n">apar</span><span class="p">]:</span>         <span class="c1"># loop over 3 possible apar files</span>
        <span class="k">if</span> <span class="n">ap</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">ap</span><span class="p">):</span>
            <span class="k">print</span> <span class="s2">&quot;Found parameter file &quot;</span><span class="p">,</span><span class="n">ap</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;cp </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ap</span><span class="p">,</span><span class="n">adir</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;All done, we just read an existing admit.xml and it should do nothing&quot;</span>
    <span class="k">print</span> <span class="s2">&quot;Use admit0.py to re-run inside of your admit directory&quot;</span>
    <span class="c1">#</span>
    <span class="n">a</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">diagram</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dir</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;admit.dot&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">a</span><span class="o">.</span><span class="n">showsetkey</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>      <span class="c1"># doesn&#39;t work in IPython!</span>

<span class="c1"># Default ADMIT plotting environment</span>
<span class="n">a</span><span class="o">.</span><span class="n">plotparams</span><span class="p">(</span><span class="n">plotmode</span><span class="p">,</span><span class="n">plottype</span><span class="p">)</span>

<span class="c1"># GenerateSpectrum</span>
<span class="c1"># here we use a little backdoor in GenerateSpectrum_AT that reads in</span>
<span class="c1"># a spectrum </span>
<span class="n">gs1</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">addtask</span><span class="p">(</span><span class="n">admit</span><span class="o">.</span><span class="n">GenerateSpectrum_AT</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="nb">file</span><span class="p">,</span><span class="n">seed</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">alias</span><span class="o">=</span><span class="n">alias</span><span class="p">))</span>
<span class="n">gstab1</span> <span class="o">=</span> <span class="p">(</span><span class="n">gs1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="k">if</span> <span class="n">stop</span> <span class="o">==</span> <span class="s1">&#39;generate&#39;</span><span class="p">:</span>  <span class="n">a</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># LineSegment</span>
<span class="n">ls1</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">addtask</span><span class="p">(</span><span class="n">admit</span><span class="o">.</span><span class="n">LineSegment_AT</span><span class="p">(),[</span><span class="n">gstab1</span><span class="p">])</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">linepar</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">a</span><span class="p">[</span><span class="n">ls1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;numsigma&#39;</span><span class="p">,</span><span class="n">linepar</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="n">ls1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;minchan&#39;</span><span class="p">,</span> <span class="n">linepar</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="n">ls1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;maxgap&#39;</span><span class="p">,</span>  <span class="n">linepar</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">a</span><span class="p">[</span><span class="n">ls1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;csub&#39;</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="n">csub</span><span class="p">])</span>
<span class="n">a</span><span class="p">[</span><span class="n">ls1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;iterate&#39;</span><span class="p">,</span><span class="n">iterate</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="n">ls1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;smooth&#39;</span><span class="p">,</span><span class="n">llsmooth</span><span class="p">)</span>
<span class="n">lstab1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ls1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="k">if</span> <span class="n">stop</span> <span class="o">==</span> <span class="s1">&#39;segment&#39;</span><span class="p">:</span>  <span class="n">a</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># LineID</span>
<span class="n">ll1</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">addtask</span><span class="p">(</span><span class="n">admit</span><span class="o">.</span><span class="n">LineID_AT</span><span class="p">(),[</span><span class="n">gstab1</span><span class="p">])</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">linepar</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">a</span><span class="p">[</span><span class="n">ll1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;numsigma&#39;</span><span class="p">,</span><span class="n">linepar</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="n">ll1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;minchan&#39;</span><span class="p">,</span> <span class="n">linepar</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">a</span><span class="p">[</span><span class="n">ll1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;maxgap&#39;</span><span class="p">,</span>  <span class="n">linepar</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="k">if</span> <span class="n">lineUID</span><span class="p">:</span>
    <span class="n">a</span><span class="p">[</span><span class="n">ll1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;identifylines&#39;</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="n">ll1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;csub&#39;</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="n">csub</span><span class="p">])</span>
<span class="n">a</span><span class="p">[</span><span class="n">ll1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;iterate&#39;</span><span class="p">,</span><span class="n">iterate</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="n">ll1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;smooth&#39;</span><span class="p">,</span><span class="n">llsmooth</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="n">ll1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;vlsr&#39;</span><span class="p">,</span><span class="n">vlsr</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="n">ll1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;references&#39;</span><span class="p">,</span><span class="n">reflist</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="n">ll1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;online&#39;</span><span class="p">,</span><span class="n">online</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="n">ll1</span><span class="p">]</span><span class="o">.</span><span class="n">setkey</span><span class="p">(</span><span class="s1">&#39;tier1width&#39;</span><span class="p">,</span><span class="n">tier1width</span><span class="p">)</span>

<span class="n">lltab1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ll1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># finish off !</span>
<span class="n">a</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">a</span><span class="o">.</span><span class="n">showsetkey</span><span class="p">(</span><span class="n">adir</span><span class="o">+</span><span class="s1">&#39;/admit.apar&#39;</span><span class="p">)</span>

</pre></div>
</td></tr></table></div>
<p>end include</p>
</div>
<div class="section" id="math">
<h2>Math<a class="headerlink" href="#math" title="Permalink to this headline">¶</a></h2>
<div class="math">
\[(project_{out},AT_{out},BDP_{out},project_{in},AT_{in},BDP_{in})\]</div>
</div>
<div class="section" id="image">
<h2>Image<a class="headerlink" href="#image" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="_images/connection.png"><img alt="_images/connection.png" src="_images/connection.png" style="width: 221.5px; height: 141.5px;" /></a>
</div>
<div class="section" id="figure">
<h2>Figure<a class="headerlink" href="#figure" title="Permalink to this headline">¶</a></h2>
<p>A figure</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/connection.png"><img alt="Example Flow." src="_images/connection.png" style="width: 487.3px; height: 311.3px;" /></a>
<p class="caption"><span class="caption-text"><strong>Figure 1:</strong> The connection in this diagram connects two ATs, <cite>a1</cite> and <cite>a2</cite>,
inside a single project <cite>p0</cite>.   The output BDP of <cite>a1</cite> is an
input BDP of <cite>a2</cite>, i.e., <span class="math">\(b1 \equiv b2\)</span>.   A given output
BDP may be the input to an arbitrary number of ATs, but can be the
output one and only one AT.   For virtual projects, the first and
fourth indices in the tuple, <cite>i1</cite> and <cite>i2</cite>, would differ.</span></p>
</div>
</div>
<div class="section" id="notes-see-also-todo">
<h2>Notes, See Also, Todo<a class="headerlink" href="#notes-see-also-todo" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a note box.  I have found that you have to end the note with a &#8221;..&#8221; comment indicator on the following line or the note absorbed everything below it at the same indent level.</p>
</div>
<p>Normal text here.</p>
</div>
<div class="section" id="design-style-at1">
<h2>Design Style AT1<a class="headerlink" href="#design-style-at1" title="Permalink to this headline">¶</a></h2>
<p><em>Description</em></p>
<p>A description of purpose of this AT.</p>
<p><em>Use Case</em></p>
<p>At least one example use case that demonstrates how this AT
fits in a typical flow.</p>
<p><em>Input BDPs</em></p>
<p>Description of input BDP(s), but note that the detailed contents of the BDPs are described elsewhere.</p>
<ul class="simple">
<li><strong>SomeName1_BDP</strong> - bla bla</li>
<li><strong>SomeName2_BDP</strong> - bla bla</li>
</ul>
<p><em>Input Keywords</em></p>
<p>Description of required and optional keywords.</p>
<ul class="simple">
<li><strong>key1</strong> - bla bla</li>
<li><strong>key2</strong> - bla bla</li>
</ul>
<p><em>Output BDPs</em></p>
<p>Description of output BDP(s), and their optional output graphics. The
naming convention of output BDP(s) is also useful to add here, as they
are normally automated (some AT&#8217;s allow you to set them explicitly).</p>
<ul class="simple">
<li><strong>SomeName1_BDP</strong> - bla bla</li>
<li><strong>SomeName2_BPD</strong> - bla bla</li>
</ul>
<p><em>Procedure</em></p>
<p>The procedure the AT uses to achieve its goals.</p>
<p><em>CASA Tasks Used</em></p>
<p>What CASA tasks (or tools) it uses.</p>
<ul class="simple">
<li><strong>task1</strong> - bla bla</li>
<li><strong>task2</strong> - bla bla</li>
<li><strong>tool3</strong> - bla bla</li>
</ul>
</div>
<div class="section" id="design-style-at2">
<h2>Design Style AT2<a class="headerlink" href="#design-style-at2" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p><em>Description</em></p>
<p>Some description.</p>
<p><em>Use Case</em></p>
<p>Some use case</p>
<p><em>Input BDPs</em></p>
<ul class="simple">
<li><strong>SomeName1</strong> - bla bla</li>
<li><strong>SomeName2</strong> - bla bla</li>
</ul>
<p><em>Input Keywords</em></p>
<ul class="simple">
<li><strong>key1</strong> - bla bla</li>
<li><strong>key2</strong> - bla bla</li>
</ul>
<p><em>Output BDPs</em></p>
<ul class="simple">
<li><strong>SomeName1</strong> - bla bla</li>
<li><strong>SomeName1</strong> - bla bla</li>
</ul>
<p><em>Procedure</em></p>
<p>The procedure</p>
<p><em>CASA Tasks Used</em></p>
<ul class="simple">
<li><strong>task1</strong> - bla bla</li>
<li><strong>task2</strong> - bla bla</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="user-guide-examples">
<h2>User Guide Examples<a class="headerlink" href="#user-guide-examples" title="Permalink to this headline">¶</a></h2>
<p>And here we will add some user guide examples.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="casapython.html">Usage of python in CASA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="casapython.html#casa-vs-numpy">CASA vs numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="casapython.html#coding-style">CODING style</a></li>
<li class="toctree-l2"><a class="reference internal" href="casapython.html#casa-and-admit">CASA and ADMIT</a></li>
</ul>
</li>
</ul>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">This is a see-also box.</p>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">This is a to-do box. (why is it not in a box??)</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Examples of various rst directives</a><ul>
<li><a class="reference internal" href="#code">Code</a></li>
<li><a class="reference internal" href="#math">Math</a></li>
<li><a class="reference internal" href="#image">Image</a></li>
<li><a class="reference internal" href="#figure">Figure</a></li>
<li><a class="reference internal" href="#notes-see-also-todo">Notes, See Also, Todo</a></li>
<li><a class="reference internal" href="#design-style-at1">Design Style AT1</a></li>
<li><a class="reference internal" href="#design-style-at2">Design Style AT2</a></li>
<li><a class="reference internal" href="#user-guide-examples">User Guide Examples</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/doctest.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ADMIT 1.0.6 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, The ADMIT Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>